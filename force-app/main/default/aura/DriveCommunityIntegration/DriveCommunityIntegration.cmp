<aura:component controller="DriveCommunityController" implements="forceCommunity:availableForAllPageTypes" access="global" >
    <aura:handler name="init" value="{!this}" action="{!c.authorizationDrive}"/>	<!-- Constructor Call at a time Component Loading Call Apex Controller -->
    <aura:handler event="aura:waiting" action="{!c.showSpinner}"/>	<!-- Show Spinner According When Complete Apex Controller Prcessiong done-->
    <aura:handler event="aura:doneWaiting" action="{!c.hideSpinner}"/>	<!-- After Complete Apex Controller Processing Done -->
    <aura:attribute name="Spinner" type="boolean" default="false"/>	<!-- Spinner Show and Hide -->
    <aura:attribute name="fileFolderList" type="List"/>  <!-- Stor All file and folder list -->
    <aura:attribute name="pathId" type="String" default="root"/> <!-- Store id of folder -->
    <aura:attribute name="breadCrumbList" type="List" default="[{name:'Drive', id:'root'}]"/>  <!-- Bread crumb List -->
    
    <aura:attribute name="isOpen" type="Boolean" default="false"/><!-- show chilc component -->
    <aura:attribute name="createFolderFlag" type="Boolean" default="false"/><!--handler event of create folder -->
    <aura:attribute name="uploadFolderFlag" type="Boolean" default="false"/><!-- handler event of upload file -->
    <aura:attribute name="childAttr" type="Boolean"/><!-- show upload modal -->
    <aura:attribute name="childAttrFolder" type="Boolean"/><!-- show create folder modal -->
    <aura:handler name="change" value="{!v.childAttr}" action="{!c.onChildAttrChange}"/><!-- call action when upload file -->
    <aura:handler name="change" value="{!v.childAttrFolder}" action="{!c.onChildAttrFolderChange}"/><!-- call action when create folder-->
    
    
    <!-- Spinner Handler -->
    <aura:if isTrue="{!v.Spinner}">
        <div aura:id="spinnerId" class="slds-spinner_container">
            <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                <span class="slds-assistive-text">Loading</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
    </aura:if>
    
    <ul class="breadcrumb">
        <aura:iteration items="{!v.breadCrumbList}" var="bKey" >             
            <li><a  onclick="{!c.breadCrumMthod}" style="width:100%;" data-index="{!bKey.id}">{!bKey.name}</a></li>        
        </aura:iteration>
    </ul><br/>
    <div class="main">
        
        <div class="slds-align_absolute-center">
            
            <table class="tableClass">
               
                <tr class="tbHeader">
                    <th class="th">File/Folder Icon</th>
                    <th>File/Folder Name</th>
                    <th>Delete</th>
                </tr>
                <aura:iteration items="{!v.fileFolderList}" var="folObj"><br/>
                    <tr>  
                        <td class="td">
                            <aura:if isTrue="{!folObj.mimeType=='application/vnd.google-apps.folder'}">
                                <img src="{!$Resource.Icons + '/ImageIcon/folder.png'}" width="30" height="30"/>
                                <aura:set attribute="else">
                                    <img src="{!$Resource.Icons + '/ImageIcon/file.png'}" width="30" height="30"/>
                                </aura:set>
                            </aura:if>                                        
                        </td>
                        <td>
                            <aura:if isTrue="{!folObj.mimeType=='application/vnd.google-apps.folder'}">
                                <h1 class="fileFolder">  <a onclick="{!c.filesAndFolder}" style="width:100%;" data-id="{!folObj.id}" data-name="{!folObj.name}" >{!folObj.name}</a></h1> 
                                <aura:set attribute="else">
                                    <h1 class="fileFolder">  <a onclick="{!c.fileDownload}" style="width:100%;" data-index="{!folObj.id}" >{!folObj.name}</a></h1> 
                                </aura:set>
                            </aura:if>  
                        </td>
                        <td>
                            <img src="{!$Resource.Icons + '/ImageIcon/delete.png'}" onclick="{!c.deleteHandler}" data-index="{!folObj.id}"  width="30" height="30"/>
                        </td>                
                    </tr>
                </aura:iteration>
                
                <!-- Empty Folder -->
                <aura:if isTrue="{!v.fileFolderList.length==0}">
                    <h1 class="fileFolder" align="center">Empty Folder</h1>
                </aura:if>
            </table><br/><br/><br/>
        </div>
        <!-- Button Handler Create and Upload-->
        <div class="btn">   
            <lightning:button   variant="brand" label="Create Folder" onclick="{!c.createFolderHandler}"/>                 
            <lightning:button   variant="brand" label="Upload File" onclick="{!c.uploadFileHandler}"/>                 
        </div>
        
        <!-- Child Component Modal -->
        <aura:if isTrue="{!v.isOpen}">
            <c:PopupDriveCreateUpload openUploadModel ="{!v.uploadFolderFlag}" parentId="{!v.pathId}"  childRes="{!v.childAttr}" childResFolder="{!v.childAttrFolder}" createFolder="{!v.createFolderFlag}" />
        </aura:if>  
    </div>
    
</aura:component>